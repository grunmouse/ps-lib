(font-base.ps) stealfile
(eskd-b-gliph.ps) stealfile
(unicode.ps) stealfile

(math.ps) stealfile
(2d.ps) stealfile
{(traverse.ps) stealfile} /many-dict-copy ifnotkey

%Матрицы прямого и наклонного шрифтов ЕСКД Б
/eskd-b-orto [0.1 0 0 0.1 0 0] def
/eskd-b-oblique [0.1 0 0.02679 0.1035 0 0] def

%Словарь-шаблон для чертёжных шрифтов
/eskd-font-base
<<
	/afterGliph{
		stroke
	}
	
	%[g]
	/setconfig {
		/g exch def %определяем g
		/right g 1 sub def %легаси
		/center right 2 div def
		
		g a add  
		0
		% Width
			
		-2 -3  
		3 index  
		h 2 add
		% Bounding box
		setcachedevice

		d setlinewidth
		
		0.5 0.5 translate
		
		2 setlinecap			
		
	}
	%[]
	

	/uppertop {
		/top h 1 sub def
		0 0 right top setABCD
	}
	
	/lowertop {
		/top c 1 sub def
		0 0 right top setABCD
	}
	
	/middlefloor {
		/middle top 2 div floor def
		center middle setMNOPQ
	}
	
	/middleceil {
		/middle top 2 div ceiling def
		center middle setMNOPQ
	}
	
	/subglyph <<
		/uml {
			gsave
				0 top 1 add translate
				1 setlinejoin 
				0 setlinecap
				0.5 1 moveto
				1 0 rlineto
				1 0 rmoveto
				1 0 rlineto
				stroke
			grestore
		}
		/breve {
			gsave
				0 top 1 add translate
				0 setlinecap
				1 1 moveto
				right 1 sub 1 lineto
				stroke
			grestore
		}
	>>

>> 
font3-base
<< >> copy copy
dup begin
	(font-tools.ps) stealfile
end

def


%=============

/eskd-b-font-base
<<
	
	%========== Специфичные члены для ЕСКД Б
	/h 10 %высота прописных букв
	/c 7  %высота строчных букв
	/a 2  %расстояние между буквами
	/b 17 %интерлиньяж
	/e 6  %расстояние между словами
	/d 1  % толщина линии
	
	/CharProcs eskd-b-gliph
	
>>
eskd-font-base
<<>> copy copy
def

/eskd-utf-encoding-dict 
	[
		(0123456789АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯабвгдеёжзийклмнопрстуфхцчшщъыьэюя ) utf8load
		(ABCDEFGHIJKLPMNOPQRSTUVWXYZ) utf8load
	]
	encoding-from-points
def

%====
%Шрифты ЕСКД

/eskd-b-font 
	eskd-utf-encoding-dict
	eskd-b-font-base
	<<
		/FontMatrix eskd-b-oblique
		/FontName (ESKD B)
	>>
	copy copy
definefont pop

/eskd-b-orto-font 
	eskd-utf-encoding-dict
	eskd-b-font-base
	<<
		/FontMatrix eskd-b-orto
		/FontName (ESKD B orto)
	>>
	copy copy
definefont pop